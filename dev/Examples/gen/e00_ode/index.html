<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>01 - Custom Orbit · FrameTransformations.jl</title><meta name="title" content="01 - Custom Orbit · FrameTransformations.jl"/><meta property="og:title" content="01 - Custom Orbit · FrameTransformations.jl"/><meta property="twitter:title" content="01 - Custom Orbit · FrameTransformations.jl"/><meta name="description" content="Documentation for FrameTransformations.jl."/><meta property="og:description" content="Documentation for FrameTransformations.jl."/><meta property="twitter:description" content="Documentation for FrameTransformations.jl."/><script data-outdated-warner src="../../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../../assets/documenter.js"></script><script src="../../../search_index.js"></script><script src="../../../siteinfo.js"></script><script src="../../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../../../"><img src="../../../assets/logo.png" alt="FrameTransformations.jl logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../../../">FrameTransformations.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../../../">Home</a></li><li><span class="tocitem">Tutorials</span><ul><li><a class="tocitem" href="../../../Tutorials/gen/t00_frames/">01 - Frame System</a></li><li><a class="tocitem" href="../../../Tutorials/gen/t01_rotation/">02 - Rotation</a></li><li><a class="tocitem" href="../../../Tutorials/gen/t02_axes/">03 - Axes</a></li><li><a class="tocitem" href="../../../Tutorials/gen/t03_points/">04 - Points</a></li></ul></li><li><span class="tocitem">Examples</span><ul><li class="is-active"><a class="tocitem" href>01 - Custom Orbit</a></li></ul></li><li><span class="tocitem">API</span><ul><li><input class="collapse-toggle" id="menuitem-4-1" type="checkbox"/><label class="tocitem" for="menuitem-4-1"><span class="docs-label">Public API</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../../API/axes_api/">Axes</a></li><li><a class="tocitem" href="../../../API/point_api/">Points</a></li><li><a class="tocitem" href="../../../API/dir_api/">Directions</a></li><li><a class="tocitem" href="../../../API/frames_api/">Frames</a></li></ul></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Examples</a></li><li class="is-active"><a href>01 - Custom Orbit</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>01 - Custom Orbit</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/JuliaSpaceMissionDesign/FrameTransformations.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/JuliaSpaceMissionDesign/FrameTransformations.jl/blob/main/docs/src/Examples/e00_ode.jl" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="example_00_ode"><a class="docs-heading-anchor" href="#example_00_ode">Use Case: Custom propagated orbit</a><a id="example_00_ode-1"></a><a class="docs-heading-anchor-permalink" href="#example_00_ode" title="Permalink"></a></h1><p><em>This example was generated on 2024-11-18T22:29:37.076.</em></p><p>Once the general structure of the <a href="../../../API/frames_api/#FrameTransformations.FrameSystem"><code>FrameSystem</code></a> is understood, we can pass to a use case in which we want to build and exploit our frame system to perform computations inserting a custom orbit. This becomes especially crucial in complex cases like Trajectory Optimization and Navigation Analysis.</p><p>In such scenarios, the trajectory is under design, and the trajectory information might not be completely available. Moreover, in these cases derivatives could be required for various quantities such as time, states, and parameters.</p><p>In this context, we shall remember that <code>FrameTransformations</code> is able to perform operations, including AD, on the frames <strong>independent variable</strong>, e.g. only time.</p><p>A proper orbit representation is essential to avoid perturbation confusion and ensure proper custom orbit handling.</p><h3 id="Frame-system-setup"><a class="docs-heading-anchor" href="#Frame-system-setup">Frame system setup</a><a id="Frame-system-setup-1"></a><a class="docs-heading-anchor-permalink" href="#Frame-system-setup" title="Permalink"></a></h3><p>First of all, a new <a href="../../../API/frames_api/#FrameTransformations.FrameSystem"><code>FrameSystem</code></a> shall be created.</p><pre><code class="language-julia hljs">using FrameTransformations

G = FrameSystem{4,Float64}()

add_axes!(G, :ICRF, 1)
add_point!(G, :Earth, 399, 1)</code></pre><div class="admonition is-info"><header class="admonition-header">Note</header><div class="admonition-body"><p>As the orbit considered in this example is custom, there is no requirement to load ephemeris.</p></div></div><h3 id="Custom-orbit-model"><a class="docs-heading-anchor" href="#Custom-orbit-model">Custom orbit model</a><a id="Custom-orbit-model-1"></a><a class="docs-heading-anchor-permalink" href="#Custom-orbit-model" title="Permalink"></a></h3><p>A custom orbit model is then required. In this case a simple two-body problem is considered but more complex models can be used. We interface with <a href="https://github.com/SciML"><code>SciML</code></a> ODE solvers to compute the trajectory solution.</p><pre><code class="language-julia hljs">using OrdinaryDiffEq
using DiffEqBase</code></pre><p>Now we create the problem with a given initial condition, time-span and gravitational parameter.</p><pre><code class="language-julia hljs">function two_body!(du, u, p, t)
    μ = p[1]
    r = sqrt(u[1]^2 + u[2]^2 + u[3]^2)
    r3 = r^3
    du[1] = u[4]
    du[2] = u[5]
    du[3] = u[6]
    du[4] = -μ * u[1] / r3
    du[5] = -μ * u[2] / r3
    du[5] = -μ * u[2] / r3
    nothing
end

u0 = [7000.0, 0.0, 0.0, 0.0, 8.0, 0.1]
p = [398600.0,]
tspan = (0, 10 * 86400.0)

prob = ODEProblem(two_body!, u0, tspan, p)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi"><span class="sgr38_2" style="color:#56b6c2">ODEProblem</span> with uType <span class="sgr38_2" style="color:#56b6c2">Vector{Float64}</span> and tType <span class="sgr38_2" style="color:#56b6c2">Float64</span>. In-place: <span class="sgr38_2" style="color:#56b6c2">true</span>
timespan: (0.0, 864000.0)
u0: 6-element Vector{Float64}:
 7000.0
    0.0
    0.0
    0.0
    8.0
    0.1</code></pre><p>It is possible to create a new node using directly the solution of the ODE problem or before the problem is solved, using the integrator:</p><pre><code class="language-julia hljs">integrator = DiffEqBase.__init(prob, Vern9(), abstol=1e-14, reltol=1e-12)
add_point_dynamical!(G, :SC, -1, 399, 1, t -&gt; @views(integrator.sol(t)[1:3]), t -&gt; integrator.sol(t))</code></pre><p>Now we can compute the trajectory:</p><pre><code class="language-julia hljs">solve!(integrator)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">retcode: Success
Interpolation: specialized 9th order lazy interpolation
t: 767-element Vector{Float64}:
      0.0
      0.002100410678471327
      0.0047599230055715425
      0.008955696574592512
      0.014405191722968853
      0.02256127192121507
      0.03376908947224431
      0.049589055530138385
      0.0698982062387515
      0.09881641196938389
      ⋮
 806236.5951903301
 813554.5837279536
 821095.7757502404
 828936.367091165
 837208.97355692
 845655.5468850702
 853693.9091403671
 862493.6137650727
 864000.0
u: 767-element Vector{Vector{Float64}}:
 [7000.0, 0.0, 0.0, 0.0, 8.0, 0.1]
 [6999.999999982056, 0.01680328542775626, 0.0002100410678471327, -1.7086197886483454e-5, 7.999999999979493, 0.1]
 [6999.999999907846, 0.03807938404440524, 0.0004759923005571542, -3.8720516530803896e-5, 7.9999999998946825, 0.1]
 [6999.99999967378, 0.07164557259562712, 0.000895569657459251, -7.285185009298929e-5, 7.999999999627178, 0.1]
 [6999.999999155986, 0.11524153377911914, 0.0014405191722968852, -0.00011718182490732019, 7.999999999035414, 0.1]
 [6999.999997929675, 0.1804901753519266, 0.002256127192121507, -0.00018352904054244176, 7.999999997633916, 0.1]
 [6999.999995361795, 0.2701527157182867, 0.003376908947224431, -0.000274701205297076, 7.999999994699195, 0.1]
 [6999.999989998091, 0.3967124440521604, 0.004958905553013839, -0.0004033917861508917, 7.999999988569248, 0.1]
 [6999.999980127922, 0.5591856493808606, 0.00698982062387515, -0.0005686005096037746, 7.999999977289055, 0.1]
 [6999.999960283645, 0.7905312942599749, 0.00988164119693839, -0.0008038412593625989, 7.999999954609882, 0.1]
 ⋮
 [27780.683963325602, 42359.01446895586, 80623.65951903291, -0.8025971884101836, 0.7920170040605534, 0.1]
 [21593.404005364973, 47617.06581630905, 81355.45837279527, -0.8843405807263419, 0.643265710217164, 0.1]
 [14685.747014284721, 51862.035932975115, 82109.57757502396, -0.9434414826071104, 0.48150113994807625, 0.1]
 [7133.1289576091995, 54962.451067493384, 82893.63670911641, -0.9787751475642218, 0.30899747628535834, 0.1]
 [-1024.0952950747117, 56763.854488823155, 83720.89735569191, -0.9888316844294007, 0.12684156398017055, 0.1]
 [-9325.026533480774, 57062.54147480205, 84565.55468850693, -0.9723707350002112, -0.055126342355960874, 0.1]
 [-17000.28781860142, 55946.09286142069, 85369.39091403662, -0.9337249254505049, -0.22127499568585487, 0.1]
 [-24945.126440130833, 53237.49061776463, 86249.36137650716, -0.8681287897346082, -0.3921808825049796, 0.1]
 [-26242.78437442029, 52625.65098316583, 86399.9999999999, -0.8546412436047252, -0.4200754020972222, 0.1]</code></pre><p>From now on we can use the frame system with the <code>:SC</code> custom node:</p><pre><code class="language-julia hljs">vector6(G, :Earth, :SC, :ICRF, 123456.0)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">6-element StaticArraysCore.SVector{6, Float64} with indices SOneTo(6):
 -12000.809592690548
  10523.77670590901
  12345.600000000011
     -2.7588011391226344
     -2.247097800159169
      0.1</code></pre><hr/><p><em>This page was generated using <a href="https://github.com/fredrikekre/Literate.jl">Literate.jl</a>.</em></p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../../../Tutorials/gen/t03_points/">« 04 - Points</a><a class="docs-footer-nextpage" href="../../../API/axes_api/">Axes »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.8.0 on <span class="colophon-date" title="Monday 18 November 2024 22:30">Monday 18 November 2024</span>. Using Julia version 1.9.4.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
