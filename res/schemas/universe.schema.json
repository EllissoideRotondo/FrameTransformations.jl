{
    "title": "Universe",
    "description": "Simulation environment definition",
    "type": "object",
    "version": "0.1.0",
    "properties": {
        "constants": {
            "description": "Environment constants configuration",
            "type": "object",
            "properties": {
                "ephemeris": {
                    "description": "Ephemeris object user-defined name",
                    "type": "array",
                    "items": {
                        "type": "string"
                    },
                    "minItems": 1,
                    "uniqueItems": true
                },
                "database": {
                    "description": "Constants loaded from database objects",
                    "type": "array",
                    "items": {
                        "type": "string"
                    },
                    "minItems": 1,
                    "uniqueItems": true
                }
            },
            "additionalProperties": false,
            "required": [
                "ephemeris"
            ]
        },
        "ephemeris": {
            "description": "Ephemeris data configuration",
            "type": "array",
            "uniqueItems": true,
            "items": {
                "type": "object",
                "additionalProperties": false,
                "properties": {
                    "name": {"type": "string", "description": "User-defined ephemeris name"},
                    "files": {
                        "type": "array",
                        "description": "Ephemeris file to load (path)",
                        "uniqueItems": true,
                        "minItems": 1,
                        "items": {"type": "string"}
                    },
                    "parser": {
                        "type": "string",
                        "description": "Ephemeris parser type",
                        "enum": ["calceph"]
                    }
                },
                "required": ["name", "files", "parser"]
            }
        },
        "mappings": {
            "description": "Environment objects mappings",
            "type": "array",
            "items": {
                "type": "object",
                "additionalProperties": false,
                "properties": {
                    "name": {"type": "string", "description": "Name of the mapping definition."},
                    "paths": {
                        "type": "array",
                        "description": "File to be loaded",
                        "items": {"type": "string"}
                    }
                },
                "required": ["name", "paths"]
            },
            "minItems": 1,
            "uniqueItems": true
        },
        "bodies": {
            "title": "Bodies",
            "description": "Define the active bodies",
            "type": "array",
            "items": {
                "type": "object",
                "additionalProperties": false,
                "properties": {
                    "name": {
                        "description": "User-defined body name. \n Handled and transformed to **CamelCase** in the simulation environment if parsed in *snake_case*, *kebab-case* or *normal text*.",
                        "type": "string"
                    },
                    "point": {
                        "description": "Name of the body",
                        "oneOf": [             
                            {"type": "string", "description": "Body name (a mapping definition shall be associated to the universe to use this)"},               
                            {"type": "number", "description": "Body NAIFID"}
                        ]
                    },
                    "center": {
                        "description": "Name of the point defined as center of the body",
                        "oneOf": [             
                            {"type": "string", "description": "Body name"},               
                            {"type": "number", "description": "Body NAIFID"}
                        ]
                    },
                    "gm": {
                        "description": "Gravitational parameter of the body",
                        "default": "Parsed from constants",
                        "oneOf": [                            
                            {"type": "number", "description": "Gravitational parameters in km,s units"},
                            {"type": "string"}
                        ]
                    },
                    "radius": {
                        "description": "Equatorial radius of the body",
                        "default": "Parsed from constants",
                        "oneOf": [                            
                            {"type": "number", "description": "Radius in km"},
                            {"type": "string"}
                        ]
                    },
                    "flattening": {
                        "description": "Flattening of the body",
                        "default": "Parsed from constants",
                        "oneOf": [                            
                            {"type": "number"},
                            {"type": "string"}
                        ]
                    },
                    "models": {
                        "description": "Body associated models specification",
                        "type": "array",
                        "uniqueItems": true,
                        "items": {
                            "oneOf": [
                                {
                                    "type": "object",
                                    "description": "Gravitational model specification",
                                    "properties": {
                                        "typed": {
                                            "description": "Model type keyword (fixed)",
                                            "type": "string",
                                            "const": "gravity"
                                        },
                                        "model": {
                                            "description": "Gravitational model used for the body",
                                            "type": "string",
                                            "enum": ["point", "polyhedron", "harmonics", "mascons"],
                                            "default": "point"
                                        },
                                        "file": {
                                            "description": "Gravitational model data file",
                                            "type": "string"
                                        }
                                    },
                                    "required": ["typed", "model"]
                                },
                                {
                                    "type": "object",
                                    "description": "Atmospheric model specification",
                                    "properties": {
                                        "typed": {
                                            "description": "Model type keyword (fixed)",
                                            "type": "string",
                                            "const": "atmosphere"
                                        },
                                        "model": {
                                            "description": "Atmospheric model used for the body",
                                            "type": "string",
                                            "enum": ["jacchia"],
                                            "default": "jacchia"
                                        },
                                        "file": {
                                            "description": "Atmospheric model data file",
                                            "type": "string"
                                        }
                                    },
                                    "required": ["typed", "model", "file"]
                                }
                            ]
                        }
                    }
                },
                "required": ["name", "point"]
            },
            "minItems": 1,
            "uniqueItems": true
        },
        "connections": {
            "description": "Bodies graph nodes connections definition",
            "type": "array",
            "minItems": 1,
            "uniqueItems": true, 
            "items": {
                "description": "Singe bodies named graph definition",
                "type": "object",
                "additionalProperties": false,
                "properties": {
                    "name": {"type": "string", "description": "Graph user-defined name"},
                    "points": {
                        "type": "array",
                        "description": "Graph nodes",
                        "uniqueItems": true,
                        "items": {
                            "type": "object", 
                            "properties": {
                                "name": {"type": "string", "description": "Body user-defined name"},
                                "parent": {"type": "string", "description": "Body parent user-defined name"},
                                "barycenter": {
                                    "type": "string", "description": "Body barycenter user-defined name",
                                    "default": "Barycenter extracted from NAIF ID - names mappings"
                                }
                            },
                            "required": ["name", "parent"],
                            "additionalProperties": false
                        }
                    }
                },
                "required": ["name", "points"]
            }
        },
        "frames": {
            "description": "Frames models definition",
            "type": "array",
            "items": {
                "type": "object",
                "anyOf": [
                    {"$ref": "#/definitions/frames/Ephemeris"},
                    {"$ref": "#/definitions/frames/FixedRotationQuaternion"},
                    {"$ref": "#/definitions/frames/FixedRotationEuler"},
                    {"$ref": "#/definitions/frames/FixedAxisAngle"}
                ]
            }
        }
    },
    "required": ["constants", "ephemeris"],
    "definitions": {
        "vector3": {
            "type": "array", 
            "description": "Three-dimensional vector",
            "maxLength": 3, "minLength": 3, 
            "items": {"type": "number"}
        },
        "frames": {
            "Ephemeris": {
                "type": "object",
                "description": "Configure points in Frames module graph",
                "additionalProperties": false,
                "properties": {
                    "source": {"type": "string", "description": "Ephemerides source user-defined name"},
                    "only": {
                        "type": "array", 
                        "items": {"type": "number"}, 
                        "description": "List of integer identifiers to load (if absent load everything)"
                    },
                    "ignore": {
                        "type": "array", 
                        "items": {"type": "number"}, 
                        "description": "List of integer identifiers to ignore"
                    }
                },
                "required": ["source"]
            }, 
            "FixedRotationQuaternion": {
                "type": "object",
                "description": "Quaternion based, fixed rotation frame (FRQ)",
                "additionalProperties": false,
                "properties": {
                    "parent": {"type": "string", "description": "Name of axes to be used as parent frame for the fixed rotation axes"},
                    "quaternion": {
                        "type": "object",
                        "description": "Quaterion",
                        "properties": {
                            "x": {"type": "number", "description": "First component of vector part (coefficient of i)"},
                            "y": {"type": "number", "description": "Second component of vector part (coefficient of j)"},
                            "z": {"type": "number", "description": "First component of vector part (coefficient of k)"},
                            "s": {"type": "number", "description": "Scalar component"}
                        },
                        "required" : ["x", "y", "z", "s"]
                    }
                },
                "required": ["parent", "quaternion"]
            },
            "FixedRotationEuler": {
                "type": "object", 
                "description": "Euler angle based, fixed rotation frame (FRE)",
                "additionalProperties": false,
                "properties": {
                    "parent": {"type": "string", "description": "Name of axes to be used as parent frame for the fixed rotation axes"},
                    "axis": {
                        "type": "string",
                        "description": "Rotation axis",
                        "enum": ["x", "y", "z"]
                    },
                    "angle": {"type": "number", "description": "Rotation angle in degrees"}
                },
                "required": ["parent", "axis", "angle"]
            },
            "FixedAxisAngle": {
                "type": "object", 
                "description": "Euler angle based, fixed rotation frame (FRE)",
                "additionalProperties": false,
                "properties": {
                    "parent": {"type": "string", "description": "Name of axes to be used as parent frame for the fixed rotation axes"},
                    "axis": {
                        "type": "array",
                        "description": "Rotation axis",
                        "items": {"type": "number"}
                    },
                    "angle": {"type": "number", "description": "Rotation angle in degrees"}
                },
                "required": ["parent", "axis", "angle"]
            }
        }
    }
}